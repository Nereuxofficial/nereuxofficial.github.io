<!doctype html><html lang=en>
<head>
<title>Cargo Plugins :: Nereuxofficials Blog</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="My favorite 5 cargo plugins">
<meta name=keywords content="rust,cargo">
<meta name=robots content="noodp">
<link rel=canonical href=/posts/cargo-plugins/>
<link rel=stylesheet href=/assets/style.css>
<link rel=stylesheet href=/assets/red.css>
<link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png>
<link rel="shortcut icon" href=/img/favicon/red.png>
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:creator content>
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="Cargo Plugins">
<meta property="og:description" content="My favorite 5 cargo plugins">
<meta property="og:url" content="/posts/cargo-plugins/">
<meta property="og:site_name" content="Nereuxofficials Blog">
<meta property="og:image" content="/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:published_time" content="2021-09-12 21:31:55 +0200 +0200">
</head>
<body class=red>
<div class="container headings--one-size">
<header class=header>
<div class=header__inner>
<div class=header__logo>
<a href=/>
<div class=logo>
Home
</div>
</a>
</div>
<div class=menu-trigger>menu</div>
</div>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about>About</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about>About</a></li>
<li><a href=/posts>Posts</a></li>
</ul>
</nav>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>
<a href=/posts/cargo-plugins/>Cargo Plugins</a></h1>
<div class=post-meta>
<span class=post-date>
2021-09-12
</span>
</div>
<span class=post-tags>
#<a href=/tags/rust/>rust</a>&nbsp;
#<a href=/tags/cargo/>cargo</a>&nbsp;
</span>
<div class=post-content><div>
<p>Here are the 5 cargo plugins I use the most(Keep in mind these depend on the use case):</p>
<h2 id=1-clippyhttpsgithubcomrust-langrust-clippy>1. <a href=https://github.com/rust-lang/rust-clippy>clippy</a><a href=#1-clippyhttpsgithubcomrust-langrust-clippy class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Clippy is by far the most useful linter, although it gives some false positives it is generally very useful for common
mistakes that can be found in Rust code.</p>
<p>For example in this code:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> vec <span style=color:#f92672>=</span> vec<span style=color:#f92672>!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>];
    increase_vec(<span style=color:#f92672>&amp;</span>vec);
}

<span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>increase_vec</span>(vector: <span style=color:#66d9ef>&amp;</span>Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u32</span><span style=color:#f92672>&gt;</span>) -&gt; Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u32</span><span style=color:#f92672>&gt;</span> {
    vector.iter().map(<span style=color:#f92672>|</span>v<span style=color:#f92672>|</span> v <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>).collect()
}
</code></pre></div><p>The default compiler gives no warnings at all. However, using <code>cargo clippy</code> in the projects' directory gives us the
following tip:
<a href=https://rust-lang.github.io/rust-clippy/master/index.html#ptr_arg><img src=./images/clippy_output.png alt="Clippy Output"></a></p>
<p>So we can replace the vector with a reference to an array which is faster since it uses one reference less.</p>
<p>Installing Clippy is very easy:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>rustup update
rustup component add clippy
</code></pre></div><p>And we can run it using: <code>cargo clippy</code></p>
<h2 id=2-cargo-checkmatehttpsgithubcomnathan-at-leastcargo-checkmate>2. <a href=https://github.com/nathan-at-least/cargo-checkmate>cargo-checkmate</a><a href=#2-cargo-checkmatehttpsgithubcomnathan-at-leastcargo-checkmate class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>This plugin bundles a bunch of other plugins together.
It first performs a <code>cargo check</code>, compares the current formatting with the one of <code>cargo fmt</code>, checks if
<code>cargo build</code> passes, checks if tests pass, then checks if the docs compile and lastly runs <code>cargo audit</code> to check for
vulnerabilities in dependencies.</p>
<p>An output will probably look something like this:
<a href=https://github.com/nathan-at-least/cargo-checkmate><img src=./images/checkmate-output.jpg alt="Checkmate Output"></a></p>
<p>You can install it via:
<code>cargo install cargo-checkmate</code></p>
<p>And to use it run:
<code>cargo checkmate</code></p>
<p>And to execute it on every commit execute:
<code>cargo checkmate git-hook install</code>
in the project folder.</p>
<h2 id=3-cargo-flamegraphhttpslibrscratesflamegraph>3. <a href=https://lib.rs/crates/flamegraph>cargo flamegraph</a><a href=#3-cargo-flamegraphhttpslibrscratesflamegraph class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Cargo flamegraph generates a so-called &ldquo;flamegraph&rdquo; of your program. It generates a graph which shows where execution
time is being spent in your program. This way it can help you figure out what to optimize in order to get better
performance out of your program.</p>
<p>By default, flamegraph will use the release output which is fine for most cases, however in order to get more
information we can add</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml>[<span style=color:#a6e22e>profile</span>.<span style=color:#a6e22e>release</span>]
<span style=color:#a6e22e>debug</span> = <span style=color:#66d9ef>true</span>
</code></pre></div><p>to our Cargo.toml.</p>
<p>To use it properly on Linux we either have to run it as root or lower <code>perf_event_paranoid</code>(Which may not fit your security
needs):</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo echo -1 | sudo tee /proc/sys/kernel/perf_event_paranoid
</code></pre></div><p>This is what a graph looks like, from the example of <a href=https://github.com/K4rakara/freshfetch>freshfetch</a>:
<a href=https://github.com/K4rakara/freshfetch><img src=./images/flamegraph_freshfetch.svg alt="Checkmate Output"></a></p>
<h2 id=4-honggfuzz-rshttpsgithubcomrust-fuzzhonggfuzz-rs>4. <a href=https://github.com/rust-fuzz/honggfuzz-rs>honggfuzz-rs</a><a href=#4-honggfuzz-rshttpsgithubcomrust-fuzzhonggfuzz-rs class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Fuzzing has become very important in software security and stability nowadays. This fuzzer, developed by Google, is
probably one of the best available.</p>
<p>We install it by using:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cargo install honggfuzz
</code></pre></div><p>Add it to project dependencies using:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml>[<span style=color:#a6e22e>dependencies</span>]
<span style=color:#a6e22e>honggfuzz</span> = <span style=color:#e6db74>&#34;0.5&#34;</span>
</code></pre></div><p>Create a target to fuzz:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>crate</span> url;
<span style=color:#66d9ef>use</span> honggfuzz::fuzz;

<span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>(){
    println(<span style=color:#e6db74>&#34;Starting fuzzer...&#34;</span>);
    <span style=color:#66d9ef>loop</span>{
        fuzz<span style=color:#f92672>!</span>(<span style=color:#f92672>|</span>data: <span style=color:#66d9ef>&amp;</span>[<span style=color:#66d9ef>u8</span>]<span style=color:#f92672>|</span> {
            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> Ok(s) <span style=color:#f92672>=</span> std::<span style=color:#66d9ef>str</span>::from_utf8(data) {
                <span style=color:#66d9ef>let</span> _ <span style=color:#f92672>=</span> url::Url::parse(s);
            }
        }
    }
}
</code></pre></div><p>Now if we run:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cargo hfuzz run TARGET <span style=color:#75715e># TARGET is typically the crate name, but it depends</span>
</code></pre></div><p>We see a terminal like this:
<a href=https://honggfuzz.dev/><img src=../images/honggfuzz.png alt="Honggfuzz Output"></a></p>
<p>While it&rsquo;s running we see a hfuzz_workspace directory, which has TARGET directory, where we can find
the found unique crashes, along with a honggfuzz report, which contains details on how it crashed.</p>
<h2 id=5-cargo-updatehttpsgithubcomnabijaczlewelicargo-update>5. <a href=https://github.com/nabijaczleweli/cargo-update>cargo-update</a><a href=#5-cargo-updatehttpsgithubcomnabijaczlewelicargo-update class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>This Plugin is used to update all the binaries we just installed.</p>
<p>Install it by using:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cargo install cargo-update
</code></pre></div><p>And update binaries using:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cargo install-update -a
</code></pre></div><p>It would probably also make sense to make it a Pacman hook(or something similar on other Linux distros).</p>
<p><a href=https://gist.github.com/Nereuxofficial/3375a8c02a2e13a51ff24206f8fd6f46>Here is mine</a>, though you need to replace the
[USER] with your username.</p>
<h2 id=conclusion>Conclusion<a href=#conclusion class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>There are obviously many Plugins I haven&rsquo;t mentioned that are very useful too, for example
<a href=https://github.com/bheisler/cargo-criterion>cargo-criterion</a>, which is useful for benchmarks or
<a href=https://github.com/kbknapp/cargo-outdated>cargo-outdated</a>, which helps you keep your dependencies up to date.</p>
<p>But I hope at least some of them were useful to you and made your workflow a bit easier.</p>
</div></div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=/posts/bitboard-rust/>
<span class=button__icon>←</span>
<span class=button__text>Writing a BitBoard in Rust</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=copyright>
<span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span>
</div>
</div>
</footer>
<script src=/assets/main.js></script>
<script src=/assets/prism.js></script>
</div>
</body>
</html>